<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="FN4004 Learning Outcomes Assessment Tool - An interactive tool for understanding and tracking progress in learning outcomes">
    <title>FN4004 Design Process 1 - Learning Outcomes Assessment Tool</title>
    
    <style>
        /* Base accessibility styles */
        :root {
            /* KSA and KU brand colors */
            --ksa-yellow: #FFF200;
            --ku-logo-white: #FFFFFF;
            --ku-logo-black: #1D1D1B;
            --text-color: #333333;
            --bg-color: #FFFFFF;
            --link-color: #0066CC;
            --border-color: #E5E7EB;
            --focus-outline: #0066CC;
            
            /* KU secondary brand colours */
            --ku-blue-dark: #002b49;
            --ku-blue-light: #4DA1D8;
            --ku-green: #78be20;
            --ku-yellow: #ffb500;
            --ku-orange: #e35205;
            --ku-teal: #77c5d5;
            --ku-brown: #857550;
            
            /* Grade colors - traffic light system */
            --grade-first-plus: #80FF80;
            --grade-first: #BFFF80;
            --grade-upper-second: #FFFF80;
            --grade-lower-second: #FFE880;
            --grade-third: #FFCC80;
            --grade-marginal-fail: #FF9980;
            --grade-fail: #FF8080;
        }
        
        /* Accessible focus styles */
        *:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
        }
        
        body {
            font-family: Arial, Helvetica, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
            color: var(--text-color);
            line-height: 1.6;
        }
        
        /* Full-width bands approach */
        .content-band {
            width: 100%;
            padding: 20px 0;
            margin: 0;
        }
        
        .band-content {
            width: 90%;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        /* Header band */
        .header-band {
            background-color: var(--ku-logo-white);
            text-align: center;
            padding: 20px 0;
        }
        
        .header-content h1 {
            margin-top: 10px;
            font-size: 24px;
        }
        
        /* Improved image handling based on understanding_grade_descriptors_v4.html */
        .logo {
            max-width: 320px;
            margin: 0 auto 15px;
            height: auto;
            display: block;
            object-fit: contain;
        }
        
        /* Getting Started band */
        .getting-started-band {
            background-color: var(--ku-blue-light);
            color: var(--ku-logo-white);
            padding: 30px 0;
        }
        
        .getting-started-content {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .getting-started-content h2,
        .getting-started-content h3 {
            color: var(--ku-logo-white);
        }
        
        .getting-started-step {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            background-color: var(--ksa-yellow);
            color: var(--ku-logo-black);
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        /* Note box with white background */
        .note-box {
            background-color: #FFFFFF;
            border-left: 4px solid var(--ksa-yellow);
            padding: 15px;
            margin: 20px 0;
            font-size: 0.95rem;
            color: #333333;
        }
        
        /* Button styles */
        .btn, .grade-btn {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 2px;
            font-weight: 500;
            cursor: pointer;
            margin: 4px;
            transition: all 0.2s;
            border: none;
            font-size: clamp(0.8rem, 1vw, 1rem);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .btn:hover, .grade-btn:hover {
            opacity: 0.9;
        }
        
        .grade-btn {
            color: #333;
            min-width: 70px;
        }
        
        .grade-btn.active {
            outline: 2px solid #666;
            outline-offset: 2px;
        }
        
        .outcome-btn {
            background-color: #f1f1f1;
            color: #333;
        }
        
        .outcome-btn.active {
            background-color: #3b82f6;
            color: white;
        }
        
        .grade-option-btn {
            background-color: white;
            border: 1px solid #ccc;
            color: #333;
            padding: 5px 10px;
            border-radius: 2px;
            font-size: 0.8rem;
            margin: 3px;
        }
        
        .grade-option-btn.active {
            background-color: var(--ksa-yellow);
            border-color: #333;
            font-weight: bold;
        }
        .ku-button {
            display: inline-block;
            background-color: var(--ksa-yellow);
            color: #000;
            font-weight: bold;
            font-size: 0.9rem;
            padding: 12px 15px;
            border-radius: 2px;
            text-decoration: none;
            margin: 10px 5px;
            border: none;
            cursor: pointer;
            text-align: center;
        }
        
        .ku-button:hover {
            background-color: #E6D900;
        }
        
        /* Assessment section styles */
        .grid {
            display: grid;
            gap: 24px;
        }
        
        @media (min-width: 768px) {
            .grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .outcomes-container {
            background-color: #f9fafb;
            padding: 24px;
            border-radius: 2px;
        }
        
        /* Improved responsive design for grade band containers */
        .grade-band-container {
            margin: 4px;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px;
            display: inline-block;
            width: auto;
        }
        
        .grade-options-container {
            display: flex;
            flex-wrap: wrap;
            gap: 3px;
            justify-content: center;
        }
        
        .grade-bands-wrapper {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 10px;
            justify-content: flex-start;
        }
        
        .grade-band-title {
            font-weight: bold;
            margin-bottom: 2px;
            text-align: center;
            font-size: 0.9rem;
        }
        
        /* Performance chart */
        #performance-chart {
            margin: 0 auto;
            max-width: 500px;
            max-height: 500px;
            width: 100%;
            height: auto;
        }
        
        /* Grade colors */
        .first-plus { background-color: var(--grade-first-plus); }
        .first { background-color: var(--grade-first); }
        .upper-second { background-color: var(--grade-upper-second); }
        .lower-second { background-color: var(--grade-lower-second); }
        .third { background-color: var(--grade-third); }
        .marginal-fail { background-color: var(--grade-marginal-fail); }
        .fail { background-color: var(--grade-fail); }
        
        /* Modal styles with improved accessibility */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 2px;
            max-width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
        }
        
        .close-modal {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            padding: 0 5px;
            line-height: 1;
        }
        
        .close-modal:hover {
            color: black;
        }
        
        /* Matrix table */
        .matrix-table, .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .matrix-table th, .matrix-table td,
        .comparison-table th, .comparison-table td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: left;
            vertical-align: top;
        }
        
        .matrix-table th:first-child,
        .comparison-table th:first-child {
            background-color: #f1f1f1;
            font-weight: bold;
            width: 20%;
            text-align: left !important;
        }
        
        .matrix-table tr:first-child th,
        .comparison-table tr:first-child th {
            text-align: center;
            padding: 8px;
            color: black;
            font-weight: bold;
        }
        
        /* Success message */
        .success-message {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #e6ffed;
            border-left: 4px solid #52c41a;
            padding: 10px 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            border-radius: 2px;
        }
        /* For improvement analysis */
        .improvement-positive {
            color: #52c41a;
            font-weight: bold;
        }
        
        .improvement-negative {
            color: #f5222d;
            font-weight: bold;
        }
        
        .improvement-neutral {
            color: #666;
        }
        
        /* Accessibility helpers */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        /* Action buttons */
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            max-width: 800px;
            margin: 30px auto;
        }
        
        @media (min-width: 768px) {
            .action-buttons {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        .full-width-button {
            grid-column: span 2;
        }
        
        @media (min-width: 768px) {
            .full-width-button {
                grid-column: span 3;
            }
        }
        
        /* Improved student name input styling */
        .student-name-container {
            display: flex;
            align-items: center;
            justify-content: center;
            max-width: 600px;
            margin: 0 auto 20px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
        }
        
        .student-name-input {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            flex-grow: 1;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 1rem;
        }
        
        /* Improved styling for "How to improve your overall grade" section */
        .improvement-section {
            margin-top: 32px;
            background-color: var(--ku-blue-light);
            color: var(--ku-logo-white);
            padding: 24px;
            border-radius: 2px;
        }
        
        .improvement-section h2,
        .improvement-section h3 {
            color: var(--ku-logo-white);
        }
        
        .improvement-section ul {
            list-style-type: disc;
            padding-left: 20px;
            margin-bottom: 20px;
        }
        
        .improvement-section li {
            margin-bottom: 8px;
        }
        
        /* Responsive styles */
        @media screen and (max-width: 768px) {
            .band-content {
                width: 95%;
            }
            
            .logo {
                max-width: 90%;
                height: auto;
            }
            
            .content {
                padding: 15px;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
            
            .full-width-button {
                grid-column: span 1;
            }
            
            /* Improved centering for student name on mobile */
            .student-name-container {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .student-name-input {
                width: 90%;
                margin-top: 5px;
            }
            
            /* Make grade bounding boxes responsive on smartphones */
            .grade-bands-wrapper {
                flex-direction: column;
                width: 100%;
            }
            
            .grade-band-container {
                width: 100%;
                height: auto;
                margin: 4px 0;
            }
        }
    </style>
</head>
<body>
    <!-- Main wrapper for all content with improved aria labeling -->
    <div id="app-wrapper" role="application" aria-label="FN4004 Learning Outcomes Assessment Tool">
        <!-- Header band with improved image handling -->
        <header class="content-band header-band" role="banner">
            <div class="band-content header-content">
                <img src="Talk_Performance_Mapping_FN4004.png" alt="FN4004 Performance Mapping Tool" class="logo">
            </div>
        </header>
        <!-- Getting Started band -->
        <section class="content-band getting-started-band" aria-labelledby="getting-started-title">
            <div class="band-content getting-started-content">
                <h2 id="getting-started-title">How to Use the Assessment Profile Tool</h2>
                <p>Welcome to your FN4004 Assessment Profile Tool! This interactive guide helps you understand how your work is assessed and identify areas for improvement.</p>
                
                <h3>Four Simple Steps:</h3>
                
                <div class="getting-started-step">
                    <span class="step-number" aria-hidden="true">1</span>
                    <div>
                        <strong>Select Your Performance Level:</strong> For each learning outcome, choose the grade band and level that best represents your current work.
                    </div>
                </div>
                
                <div class="getting-started-step">
                    <span class="step-number" aria-hidden="true">2</span>
                    <div>
                        <strong>Review Your Profile:</strong> The radar chart shows your overall performance across all learning outcomes. Notice which areas are stronger and which need improvement.
                    </div>
                </div>
                
                <div class="getting-started-step">
                    <span class="step-number" aria-hidden="true">3</span>
                    <div>
                        <strong>Read Detailed Feedback:</strong> Scroll down to see specific feedback for each learning outcome with advice on how to improve.
                    </div>
                </div>
                
                <div class="getting-started-step">
                    <span class="step-number" aria-hidden="true">4</span>
                    <div>
                        <strong>Save Your Profile:</strong> Click "Save My Assessment Profile" to download your current assessment. Save this to your OneDrive to track your progress over time.
                    </div>
                </div>
                
                <h3>Tips for Getting the Most from This Tool:</h3>
                <ul>
                    <li>Be honest in your self-assessment — this is for your learning, not for grading</li>
                    <li>Review the examples of good work on your Canvas Module Homepage</li>
                    <li>Discuss your profile with peers and tutors in group tutorials</li>
                    <li>Save profiles regularly to track your improvement over time</li>
                </ul>
            </div>
        </section>
        
        <!-- Note box placed outside the blue background with white background -->
        <section class="content-band" style="background-color: #f9f9f9; padding: 10px 0;">
            <div class="band-content">
                <div class="note-box" role="note">
                    <p><strong>Note:</strong> Look for Examples and Exemplars of Good Work on your Canvas Module Homepage to help you understand what different grade levels look like in practice.</p>
                </div>
            </div>
        </section>

        <!-- Student Name Input Section with improved mobile centering -->
        <section class="content-band" style="background-color: white; padding: 10px 0;">
            <div class="band-content">
                <div class="student-name-container">
                    <label for="student-name" style="margin-right: 15px; font-weight: bold;">Your Name:</label>
                    <input 
                        type="text"
                        id="student-name"
                        class="student-name-input"
                        placeholder="Enter your name (optional)"
                        aria-label="Enter your name for your assessment profile"
                    >
                </div>
            </div>
        </section>
        <!-- Main assessment tool -->
        <main class="content-band" aria-labelledby="assessment-title">
            <div class="band-content">
                <h2 id="assessment-title" class="sr-only">Assessment Tool</h2>
                
                <div class="grid">
                    <!-- Left column - Inputs -->
                    <div class="outcomes-container">
                        <h2>Your Performance Level by Outcome</h2>
                        
                        <div id="outcomes-container" role="group" aria-label="Learning outcomes assessment">
                            <!-- Learning outcomes will be generated here by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Right column - Results -->
                    <div>
                        <!-- Performance Chart -->
                        <div style="background-color: white; padding: 16px; border-radius: 2px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 24px; text-align: center;">
                            <h2>Your Performance Profile</h2>
                            <div style="display: flex; justify-content: center; margin-bottom: 20px;">
                                <canvas id="performance-chart" width="400" height="400" role="img" aria-label="Performance radar chart showing your grades across all learning outcomes"></canvas>
                            </div>
                            <!-- Legend for Learning Outcomes -->
                            <div class="chart-legend" style="max-width: 400px; margin: 0 auto; text-align: left; font-size: 0.85rem;">
                                <div style="font-weight: bold; margin-bottom: 8px;">Learning Outcomes:</div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                    <div><strong>LO1:</strong> Research for Creative Design</div>
                                    <div><strong>LO2:</strong> Design Development Process</div>
                                    <div><strong>LO3:</strong> Material Understanding</div>
                                    <div><strong>LO4:</strong> Historical & Ethical Research</div>
                                    <div><strong>LO5:</strong> Design Communication</div>
                                    <div><strong>LO6:</strong> Personal & Professional Development</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Indicative average grade -->
                        <div style="background-color: white; padding: 16px; border-radius: 2px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 24px;">
                            <h2 class="text-center">Indicative Average Grade</h2>
                            <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 12px; text-align: center;">Note: This is for reference only and not an official grade calculation.</p>
                            <div id="average-grade-display" class="first" style="display: flex; align-items: center; justify-content: center; gap: 16px; padding: 16px; border-radius: 2px; background-color: #BFFF80;">
                                <div id="grade-title" style="font-size: 1.25rem; font-weight: 700;">Upper Second (2:1)</div>
                                <div id="numeric-grade" style="font-size: 3rem; font-weight: 700;">68%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Bottom section - Detailed feedback -->
                <div style="margin-top: 32px; background-color: #f9fafb; padding: 24px; border-radius: 2px;">
                    <h2>Your Detailed Assessment Profile</h2>
                    
                    <div id="detailed-feedback" class="grid" style="display: grid; gap: 24px;">
                        <!-- Detailed feedback cards will be generated here by JavaScript -->
                    </div>
                </div>
                <!-- Key Areas for Improvement / Overall Advice section - Now with blue background & white text -->
                <div id="improvement-section" class="improvement-section">
                    <h2>How to improve your overall grade:</h2>
                    
                    <h3 style="font-weight: 600; margin-top: 16px; margin-bottom: 8px;">Key Areas for Improvement:</h3>
                    <ul id="key-improvements">
                        <!-- Improvement items will be generated here by JavaScript -->
                    </ul>
                    
                    <h3 style="font-weight: 600; margin-top: 16px; margin-bottom: 8px;">Overall Recommendations:</h3>
                    <ul id="overall-advice">
                        <!-- Overall advice items will be generated here by JavaScript -->
                    </ul>
                </div>
                
                <!-- Action buttons with improved accessibility -->
                <div class="action-buttons">
                    <button id="save-profile-btn" class="ku-button" aria-label="Save your assessment profile to your device">
                        Save My Assessment Profile
                    </button>
                    
                    <!-- Load Profile Button -->
                    <button id="load-profile-btn" class="ku-button" aria-label="Load a previously saved assessment profile">
                        Load Previous Assessment
                    </button>
                    
                    <button id="compare-profiles-btn" class="ku-button" disabled style="opacity: 0.5;" aria-label="Compare with previous assessments" aria-disabled="true">
                        Compare with Previous Assessments
                    </button>
                    
                    <button id="print-summary-btn" class="ku-button" aria-label="Print assessment summary">
                        Print Assessment Summary
                    </button>
                    
                    <button id="matrix-button" class="ku-button" aria-label="View complete grade descriptor matrix">
                        Complete FN4004 Grade Descriptor Matrix
                    </button>
                    
                    <a 
                        href="https://canvas.kingston.ac.uk/courses/8255/pages/7-fairness-in-assessment" 
                        class="ku-button"
                        target="_blank"
                        rel="noopener noreferrer"
                        aria-label="View fairness in assessment information (opens in new tab)"
                    >
                        Fairness in Assessment
                    </a>
                    
                    <a 
                        href="https://kingstonuniversity.sharepoint.com/sites/mykingston/mysupport/myskills/Pages/default.aspx" 
                        class="ku-button"
                        target="_blank"
                        rel="noopener noreferrer"
                        aria-label="View support for building academic skills (opens in new tab)"
                    >
                        Support for Building Academic Skills
                    </a>
                    
                    <a 
                        href="https://canvas.kingston.ac.uk/courses/32501" 
                        class="ku-button full-width-button"
                        target="_blank"
                        rel="noopener noreferrer"
                        aria-label="Return to module home page (opens in new tab)"
                    >
                        Back to Module Home Page
                    </a>
                </div>
                
                <!-- Footer Note -->
                <div class="note-box" role="note" style="margin-top: 30px;">
                    <p>Note: This is a visual interpretation of the Kingston School of Art BA (Hons) Fashion grade descriptors for FN4004. Always refer to the official grade descriptors in your course handbook for definitive guidance.</p>
                </div>
                
                <!-- Success message with improved accessibility -->
                <div id="success-message" class="success-message" role="alert" aria-live="polite">
                    <div style="display: flex; align-items: center;">
                        <div style="margin-right: 10px;">✓</div>
                        <div>
                            <p style="font-weight: bold; margin: 0;">Assessment Profile Saved!</p>
                            <p style="font-size: 0.8rem; margin: 0;">You can now compare with previous assessments.</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Hidden file input for profile upload -->
        <input type="file" id="profile-upload" accept=".json" style="display: none;" aria-hidden="true">
        
        <!-- Grade Descriptor Matrix Modal with LO6 added -->
        <div id="matrix-modal" class="modal" role="dialog" aria-labelledby="matrix-title" aria-modal="true" aria-hidden="true">
            <div class="modal-content">
                <button type="button" class="close-modal" id="close-matrix" aria-label="Close matrix">&times;</button>
                <h2 id="matrix-title">Complete FN4004 Grade Descriptor Matrix</h2>
                
                <div style="margin: 20px 0;">
                    <p>The following matrix maps the FN4004 Learning Outcomes against grade descriptors, showing what is expected at each level of achievement.</p>
                </div>
                
                <div style="overflow-x: auto;">
                    <table class="matrix-table">
                        <caption class="sr-only">Grade descriptor matrix for FN4004 learning outcomes</caption>
                        <thead>
                            <tr>
                                <th scope="col">Learning Outcomes</th>
                                <th scope="col" class="first-plus">Distinction<br>85-100%</th>
                                <th scope="col" class="first">First Class<br>70-84%</th>
                                <th scope="col" class="upper-second">Upper Second (2:1)<br>60-69%</th>
                                <th scope="col" class="lower-second">Lower Second (2:2)<br>50-59%</th>
                                <th scope="col" class="third">Third Class<br>40-49%</th>
                                <th scope="col" class="marginal-fail">Marginal Fail<br>35-39%</th>
                                <th scope="col" class="fail">Fail<br>0-34%</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">LO1:<br>Use research sources as a basis for creative design by exploring, evaluating and originating ideas into contemporary fashion concepts.</th>
                                <td>Outstanding and exceptional use of research sources that go far beyond requirements; highly original thinking.</td>
                                <td>Excellent use of research sources showing deep understanding and creative application to design development.</td>
                                <td>Good ability to use research sources with solid evaluation and critical thinking skills.</td>
                                <td>Satisfactory use of research sources with some evidence of evaluation.</td>
                                <td>Basic understanding of research sources with limited application to design.</td>
                                <td>Limited understanding of how to use research sources for design development.</td>
                                <td>Very little evidence of research informing design work.</td>
                            </tr>
<tr>
                                <th scope="row">LO2:<br>Creatively generate, collate and record information appropriate to the design development process.</th>
                                <td>Exceptional creativity and innovation in generating and documenting design development with expert organization.</td>
                                <td>Excellent ability to confidently generate creative ideas and record them effectively through the design process.</td>
                                <td>Good confidence in generating and recording design ideas with clear progression.</td>
                                <td>Satisfactory ability to generate and record design information with some creative elements.</td>
                                <td>Basic ability to generate and record design ideas with minimal organization.</td>
                                <td>Limited ability to generate or record design information effectively.</td>
                                <td>Insufficient evidence of generating or recording design information.</td>
                            </tr>
                            <tr>
                                <th scope="row">LO3:<br>Demonstrate an understanding of material qualities and evaluate their application and appropriateness to design outcomes.</th>
                                <td>Outstanding understanding of materials with exceptional evaluation skills for innovative applications.</td>
                                <td>Excellent understanding of material qualities with very good evaluation skills for design outcomes.</td>
                                <td>Good understanding of material qualities with solid evaluation of their design applications.</td>
                                <td>Satisfactory understanding of materials with some evaluation of their design applications.</td>
                                <td>Basic understanding of materials with limited evaluation of their design applications.</td>
                                <td>Limited understanding of materials with very little evaluation.</td>
                                <td>Very little evidence of material understanding or evaluation.</td>
                            </tr>
                            <tr>
                                <th scope="row">LO4:<br>Advance research into creative concepts that recognise historical and/or ethical and social considerations.</th>
                                <td>Exceptional ability to research creative concepts with outstanding recognition of complex historical, ethical, and social contexts.</td>
                                <td>Excellent research into creative concepts with strong historical, ethical, and social awareness.</td>
                                <td>Good research with clear recognition of historical and ethical considerations.</td>
                                <td>Satisfactory research with some recognition of historical and ethical considerations.</td>
                                <td>Basic research with limited recognition of historical or ethical considerations.</td>
                                <td>Limited research with minimal recognition of historical or ethical considerations.</td>
                                <td>Very little evidence of research into historical or ethical considerations.</td>
                            </tr>
                            <tr>
                                <th scope="row">LO5:<br>Communicate design outcomes using a variety of traditional and contemporary methods appropriate to professional contexts.</th>
                                <td>Outstanding communication of design outcomes using exceptionally skilled and innovative methods suitable for professional contexts.</td>
                                <td>Excellent communication of design outcomes using highly skilled traditional and contemporary methods.</td>
                                <td>Good communication of design outcomes with skillful use of appropriate methods.</td>
                                <td>Satisfactory communication of design outcomes using appropriate methods.</td>
                                <td>Basic communication of design outcomes with limited method variety.</td>
                                <td>Limited ability to communicate design outcomes effectively.</td>
                                <td>Very little evidence of ability to communicate design outcomes.</td>
                            </tr>
                            <tr>
                                <th scope="row">LO6:<br>Personal & Professional Development: Planning, time-management, commitment & subject engagement</th>
                                <td>Integration of own identity in real or simulated work/subject contexts. Can work highly productively individually, in a team or in a leadership role.</td>
                                <td>Takes full responsibility for own learning understanding subject possibilities and requirements. Can work comfortably independently, in a team or as a leader.</td>
                                <td>Self-directed reflection and planning process clearly evidenced in the development of work and context of subject possibilities. Works well alone or in a collaborative team.</td>
                                <td>Actively working to develop understanding of subject and use process of reflection and effective planning to improve work. Productive working alone or in a team.</td>
                                <td>Evidence in awareness of subject and strengths, may lack consistency in applying reflection and planning. Able to work alone or collaboratively.</td>
                                <td>Limited awareness of subject, personal strengths or evidence of reflection or planning and application.</td>
                                <td>Little or no awareness of subject, personal strengths or evidence of reflection or planning and application.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button id="close-matrix-btn" class="ku-button" style="width: auto;">Close</button>
                </div>
            </div>
        </div>
        
        <!-- Compare Profiles Modal with improved accessibility and student name column -->
        <div id="compare-modal" class="modal" role="dialog" aria-labelledby="compare-title" aria-modal="true" aria-hidden="true">
            <div class="modal-content">
                <button type="button" class="close-modal" id="close-compare" aria-label="Close comparison">&times;</button>
                <h2 id="compare-title">Compare with Previous Assessments</h2>
                
                <div id="compare-content">
                    <div id="no-profiles" style="text-align: center; padding: 30px; display: none;">
                        <p>No saved assessment profiles found.</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">Save your current assessment to enable comparison.</p>
                    </div>
                    
                    <div id="has-profiles">
                        <div style="margin-bottom: 20px;">
                            <h3>Progress Over Time</h3>
                            <div style="background-color: #f9fafb; padding: 16px; border-radius: 2px; overflow-x: auto;">
                                <table id="progress-table" class="comparison-table">
                                    <!-- Progress table content will be generated here by JavaScript -->
                                </table>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h3>Improvement Analysis</h3>
                            <div style="background-color: white; padding: 16px; border-radius: 2px; border: 1px solid #e5e7eb;">
                                <h4 id="previous-date" style="font-weight: 600; margin-bottom: 10px;">Compared to previous assessment:</h4>
                                <ul id="improvement-list" style="list-style-type: disc; padding-left: 20px;">
                                    <!-- Improvement list will be generated here by JavaScript -->
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button id="close-compare-btn" class="ku-button" style="width: auto;">Close</button>
                </div>
            </div>
        </div>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Learning outcomes data
        const learningOutcomes = [
            {
                id: 'outcome1',
                title: 'LO1: Research for Creative Design',
                description: 'Use research sources as a basis for creative design by exploring, evaluating and originating ideas into contemporary fashion concepts.',
                framework: 'Research and Analysis',
                feedback: {
                    'first-plus': {
                        strength: "Your work shows outstanding and exceptional use of research sources that go far beyond requirements, showcasing unique insights and original thinking.",
                        evidence: "While your research is excellent, you could explore even more unconventional sources that challenge established design paradigms. Consider investigating interdisciplinary connections that might further push the boundaries of fashion concepts.",
                        improvement: "Continue developing your exceptional research approach by exploring even more specialized or interdisciplinary sources that could further push fashion boundaries."
                    },
                    'first': {
                        strength: "Your work shows excellent use of research sources with deep understanding and creative application to design development.",
                        evidence: "Your research could benefit from more diverse or unexpected sources beyond conventional fashion references. Work on developing a more distinctive critical voice when analyzing sources and be more explicit about your analytical process in your documentation.",
                        improvement: "To reach A+ level, push your research beyond the expected sources and demonstrate more innovative connections between research and design concepts."
                    },
                    'upper-second': {
                        strength: "Your work shows good ability to use research sources as a foundation for creative design work with solid evaluation skills.",
                        evidence: "Your research sources are somewhat predictable and your analysis needs more depth. Challenge yourself to explore beyond obvious references and develop a more rigorous methodology for analyzing sources. More explicit connections between research and design concepts would strengthen your work.",
                        improvement: "Deepen your critical analysis of research sources and show more creative connections between research and design development to move toward a First."
                    },
                    'lower-second': {
                        strength: "Your work shows satisfactory use of research sources with some evidence of evaluation and idea development.",
                        evidence: "Your research is limited to obvious or surface-level sources, and your analysis remains primarily descriptive rather than critical. You need to demonstrate a more methodical approach to research and show clearer evaluation of how research informs design decisions.",
                        improvement: "Focus on developing stronger analytical skills when evaluating research, and show clearer connections between research and design outcomes."
                    },
                    'third': {
                        strength: "Your work shows adequate use of research sources with basic understanding of how to apply them to design.",
                        evidence: "Your research is minimal and lacks variety, with little evidence of analysis beyond description. You need to significantly expand the range of sources consulted and develop a framework for evaluating their relevance to your design work.",
                        improvement: "Expand your research beyond obvious sources and develop your analytical skills to evaluate research more critically."
                    },
                    'marginal-fail': {
                        strength: "Your work shows limited understanding of how to use research sources for design development.",
                        evidence: "Your research is severely inadequate in scope and depth, with little to no analysis evident. There is minimal connection between the limited research presented and your design concepts. A structured approach to research collection and analysis is notably absent.",
                        improvement: "Build a more structured approach to research, gathering more diverse sources and practice analyzing them in relation to your design ideas."
                    },
                    'fail': {
                        strength: "Your work shows very little evidence of research informing design work.",
                        evidence: "There is almost no identifiable research in your work, or research that is present is irrelevant to your design concepts. You need to understand the fundamental purpose of research within the design process and develop basic skills in sourcing and analyzing information.",
                        improvement: "Develop a basic understanding of research methods and how to apply research to inform design decisions and concepts."
                    }
                }
            },
            {
                id: 'outcome2',
                title: 'LO2: Design Development Process',
                description: 'Creatively generate, collate and record information appropriate to the design development process.',
                framework: 'Experimentation and Practice',
                feedback: {
                    'first-plus': {
                        strength: "Your work shows exceptional confidence and creativity in generating, organizing, and documenting design development.",
                        evidence: "While your documentation is excellent, you could experiment with even more innovative approaches to recording your process. Consider developing a more personalized documentation system that captures nuances of your creative thinking that conventional methods might miss.",
                        improvement: "Continue your excellent practice, perhaps exploring even more innovative methods of recording and presenting your design process."
                    },
                    'first': {
                        strength: "Your work shows excellent ability to confidently generate creative ideas and record them effectively throughout the design process.",
                        evidence: "Your documentation follows relatively conventional formats. Challenge yourself to develop more innovative or unexpected ways of capturing your design journey. The organization of information could be more strategic to highlight the critical moments in your development process.",
                        improvement: "To reach A+ level, experiment with more innovative or unexpected methods of recording your design process and organizing information."
                    },
                    'upper-second': {
                        strength: "Your work shows good confidence in generating and recording design ideas with clear progression.",
                        evidence: "Your process documentation lacks creative presentation and distinctive organization. There are gaps in your developmental journey that limit understanding of key decision points. More consistent and thorough documentation would better demonstrate your creative thinking process.",
                        improvement: "Work on developing more creative approaches to recording your design process and show more confidence in pursuing original ideas."
                    },
                    'lower-second': {
                        strength: "Your work shows satisfactory ability to generate and record design information with some creative elements.",
                        evidence: "Your documentation is inconsistent and lacks clarity in showing progression of ideas. The organizational structure is basic and doesn't effectively highlight development of concepts. Design decisions often appear without clear rationale or developmental stages.",
                        improvement: "Improve the creativity and clarity in how you document your design process, showing more thoughtful organization and progression of ideas."
                    },
                    'third': {
                        strength: "Your work shows basic ability to generate and record design ideas.",
                        evidence: "Your documentation is minimal and disorganized, making it difficult to follow your design journey. You frequently omit critical developmental stages, and your recording methods lack variety. There is little evidence of reflection on process or methodology.",
                        improvement: "Develop a more structured approach to organizing your portfolio and experiment with more creative ways to record your design process."
                    },
                    'marginal-fail': {
                        strength: "Your work shows limited ability to generate or record design information.",
                        evidence: "Your documentation is severely insufficient, with significant gaps that make it impossible to understand how ideas developed. Recording methods are rudimentary with no evidence of organization or methodology. Design decisions appear arbitrary with no visible development process.",
                        improvement: "Practice basic methods of recording design development and organizing information in a logical sequence."
                    },
                    'fail': {
                        strength: "Your work shows insufficient evidence of generating or recording design information.",
                        evidence: "There is almost no documentation of your design process or it is so chaotic that no progression can be discerned. You need to understand the fundamental importance of recording design development and develop basic organizational systems for your work.",
                        improvement: "Learn and apply fundamental principles of documenting design development and organizing information appropriately."
                    }
                }
            },
            {
                id: 'outcome3',
                title: 'LO3: Material Understanding',
                description: 'Demonstrate an understanding of material qualities and evaluate their application and appropriateness to design outcomes.',
                framework: 'Experimentation and Practice',
                feedback: {
                    'first-plus': {
                        strength: "Your work shows outstanding understanding of materials with exceptional ability to evaluate their qualities for innovative design applications.",
                        evidence: "To further develop your excellent material knowledge, you could explore more speculative applications that challenge conventional thinking about materials. Consider investigating emerging sustainable materials and processes that push the boundaries of current practice.",
                        improvement: "Continue your exceptional material investigations, perhaps exploring even more sustainable or cutting-edge materials."
                    },
                    'first': {
                        strength: "Your work shows excellent understanding of material qualities with very good evaluation skills for design outcomes.",
                        evidence: "Your material investigations could be more experimental and risk-taking. While you demonstrate good technical knowledge, you need to push boundaries with more innovative applications and more comprehensive testing of material limitations and possibilities.",
                        improvement: "To reach A+ level, deepen your exploration of material innovation and consider more experimental applications in your designs."
                    },
                    'upper-second': {
                        strength: "Your work shows good understanding of material qualities with solid evaluation of their design applications.",
                        evidence: "Your material exploration remains relatively safe and predictable. You need to conduct more thorough testing of properties and investigate unconventional applications. Your evaluation criteria should be more sophisticated, considering factors beyond the obvious functional and aesthetic properties.",
                        improvement: "Develop a more sophisticated understanding of material properties and experiment with more creative or unexpected applications."
                    },
                    'lower-second': {
                        strength: "Your work shows satisfactory understanding of materials with some evaluation of their design applications.",
                        evidence: "Your material investigations are superficial and lack methodical testing. You often select materials based on limited criteria without proper consideration of alternatives. Your evaluation needs to be more systematic and consider a broader range of properties relevant to your design intentions.",
                        improvement: "Enhance your material investigation with more in-depth analysis of properties and more thoughtful consideration of design applications."
                    },
                    'third': {
                        strength: "Your work shows basic understanding of materials with limited evaluation of their design applications.",
                        evidence: "Your knowledge of materials is very limited, with minimal evidence of testing or exploration. You often make inappropriate material choices that don't align with your design intentions. Your evaluation lacks structure and fails to consider essential properties like durability, sustainability, or fabrication requirements.",
                        improvement: "Develop a more structured approach to investigating materials and practice evaluating their properties for specific design outcomes."
                    },
                    'marginal-fail': {
                        strength: "Your work shows limited understanding of materials with very little evaluation.",
                        evidence: "Your work shows significant gaps in basic material knowledge and almost no evidence of testing or exploration. Material selections appear arbitrary and unsuitable for your design intentions. You need to develop fundamental understanding of how material properties affect design outcomes.",
                        improvement: "Build basic knowledge of material properties and practice simple evaluation techniques for design applications."
                    },
                    'fail': {
                        strength: "Your work shows very little evidence of material understanding or evaluation.",
                        evidence: "There is almost no evidence of material consideration in your work. You need to develop awareness of even the most basic material properties and how they relate to design applications. Your work lacks any coherent approach to material selection or evaluation.",
                        improvement: "Learn fundamental principles of material properties and how they relate to design outcomes."
                    }
                }
            },
            {
                id: 'outcome4',
                title: 'LO4: Historical & Ethical Research',
                description: 'Advance research into creative concepts that recognise historical and/or ethical and social considerations.',
                framework: 'Research and Analysis',
                feedback: {
                    'first-plus': {
                        strength: "Your work shows exceptional ability to research creative concepts with outstanding recognition of historical, ethical, and social contexts.",
                        evidence: "To further develop your excellent contextual understanding, you could engage more deeply with emerging ethical debates within fashion, such as labor practices and cultural appropriation. Consider more critically examining power dynamics and privilege within historical fashion narratives.",
                        improvement: "Continue your excellent contextual research, perhaps exploring even more nuanced ethical or cultural considerations in fashion."
                    },
                    'first': {
                        strength: "Your work shows excellent research into creative concepts with strong historical, ethical, and social awareness.",
                        evidence: "Your contextual research could be more challenging of established narratives. While you make good connections to ethical considerations, your analysis could be more critical of power structures and privilege within fashion's historical and contemporary contexts. More explicit integration of ethical considerations into your design thinking is needed.",
                        improvement: "To reach A+ level, develop even deeper insights into historical contexts or ethical considerations that challenge conventional thinking."
                    },
                    'upper-second': {
                        strength: "Your work shows good research with clear recognition of historical and ethical considerations.",
                        evidence: "Your historical and ethical research remains somewhat superficial, addressing obvious issues without deeper critical analysis. You need to move beyond describing ethical concerns to analyzing their implications for design practice. Your understanding of historical contexts would benefit from more nuanced consideration of social and cultural factors.",
                        improvement: "Deepen your exploration of historical and ethical contexts and show more sophisticated integration into your creative concepts."
                    },
                    'lower-second': {
                        strength: "Your work shows satisfactory research with some recognition of historical and ethical considerations.",
                        evidence: "Your contextual research is limited and often disconnected from your design work. You demonstrate only basic awareness of ethical considerations without meaningful analysis. Historical references are used in a descriptive rather than analytical way, with limited understanding of their contexts.",
                        improvement: "Strengthen your research into historical and ethical contexts and make clearer connections to your design development."
                    },
                    'third': {
                        strength: "Your work shows basic research with limited recognition of historical or ethical considerations.",
                        evidence: "Your work shows minimal acknowledgment of historical or ethical contexts, with significant gaps in understanding. Connections between contextual research and design concepts are weak or missing. You need to develop a more structured approach to investigating these areas and their relevance to fashion design.",
                        improvement: "Develop a more structured approach to researching historical and ethical contexts and practice applying these to your design work."
                    },
                    'marginal-fail': {
                        strength: "Your work shows limited research with minimal recognition of historical or ethical considerations.",
                        evidence: "Your work demonstrates very little awareness of historical contexts or ethical implications in fashion. There are major gaps in understanding basic concepts relevant to responsible design practice. You need to develop foundational knowledge of how fashion operates within broader historical, social, and ethical frameworks.",
                        improvement: "Build basic understanding of how historical and ethical considerations influence fashion design and practice incorporating these into your research."
                    },
                    'fail': {
                        strength: "Your work shows very little evidence of research into historical or ethical considerations.",
                        evidence: "There is almost no acknowledgment of historical contexts or ethical considerations in your work. You need to develop awareness of even the most basic historical references or ethical concerns in fashion practice. Your work exists in isolation from broader contextual frameworks.",
                        improvement: "Learn fundamental principles of historical and ethical research in fashion and begin to incorporate these into your design thinking."
                    }
                }
            },
            {
                id: 'outcome5',
                title: 'LO5: Design Communication',
                description: 'Communicate design outcomes using a variety of traditional and contemporary methods appropriate to professional contexts.',
                framework: 'Communication and Presentation',
                feedback: {
                    'first-plus': {
                        strength: "Your work shows outstanding communication of design outcomes using exceptionally skilled and innovative methods.",
                        evidence: "While your communication skills are excellent, you could experiment with even more cutting-edge presentation techniques that challenge industry conventions. Consider how emerging technologies or alternative platforms might further enhance the communication of your concepts.",
                        improvement: "Continue exploring cutting-edge communication methods while maintaining your exceptional standard of presentation."
                    },
                    'first': {
                        strength: "Your work shows excellent communication of design outcomes using highly skilled traditional and contemporary methods.",
                        evidence: "Your presentation methods, while effective, could be more innovative or unexpected. You need to push boundaries in how you communicate your ideas, exploring techniques that might better capture the unique aspects of your design thinking. Consider more carefully how your presentation strategy aligns with your design philosophy.",
                        improvement: "To reach A+ level, experiment with more innovative or unexpected communication methods that push boundaries while maintaining clarity."
                    },
                    'upper-second': {
                        strength: "Your work shows good communication of design outcomes with skillful use of appropriate methods.",
                        evidence: "Your presentation techniques are relatively conventional and safe. You need to develop more variety in your communication methods and ensure more consistent quality across all elements. Your consideration of audience needs and context could be more sophisticated to ensure maximum impact.",
                        improvement: "Develop more creative and sophisticated communication techniques and ensure consistent professional quality throughout."
                    },
                    'lower-second': {
                        strength: "Your work shows satisfactory communication of design outcomes using appropriate methods.",
                        evidence: "Your communication lacks refinement and creativity, with inconsistent quality across different elements. Your choice of presentation methods often doesn't align well with your design concepts or target audience. Technical execution needs improvement to meet professional standards.",
                        improvement: "Improve the consistency and creativity of your communication methods, paying more attention to professional presentation standards."
                    },
                    'third': {
                        strength: "Your work shows basic communication of design outcomes with limited method variety.",
                        evidence: "Your presentation skills are underdeveloped, with poor technical execution and limited variety in methods. You show little awareness of audience needs or professional contexts. Your communication fails to effectively convey the intent behind your designs or key aspects of your concepts.",
                        improvement: "Develop a wider range of communication techniques and practice applying them to present your ideas more professionally."
                    },
                    'marginal-fail': {
                        strength: "Your work shows limited ability to communicate design outcomes effectively.",
                        evidence: "Your presentation is significantly below the standard expected at this level, with major technical flaws and inappropriate choice of methods. Your communication fails to convey basic information about your designs. You show minimal understanding of professional presentation requirements.",
                        improvement: "Learn and practice basic presentation techniques and focus on clearly communicating your design intentions."
                    },
                    'fail': {
                        strength: "Your work shows very little evidence of ability to communicate design outcomes.",
                        evidence: "There is almost no effective communication of your design concepts. Your presentation lacks even the most basic organization or technical competence. You need to develop fundamental understanding of how to present design work to others in a clear and accessible way.",
                        improvement: "Develop fundamental communication skills and learn standard methods for presenting fashion design work."
                    }
                }
            },
            {
                id: 'outcome6',
                title: 'LO6: Personal & Professional Development',
                description: 'Demonstrate effective planning, time-management, commitment & subject engagement, including the ability to work independently and collaboratively.',
                framework: 'Personal and Professional Development',
                feedback: {
                    'first-plus': {
                        strength: "Your work shows exceptional commitment and self-management with outstanding professional conduct.",
                        evidence: "While your professional approach is excellent, you could develop more advanced leadership skills within collaborative contexts. Consider how you might further mentor peers or facilitate knowledge exchange within your cohort as part of your professional development.",
                        improvement: "Continue to develop your excellent professional approach by taking on leadership roles and mentoring others."
                    },
                    'first': {
                        strength: "Your work shows excellent commitment and self-management with very strong professional conduct.",
                        evidence: "Your approach to teamwork could be more proactive, particularly in leadership contexts. You need to develop more advanced strategies for managing complex projects and navigating challenging collaborative dynamics. Your reflection on your own professional development could be more structured and forward-looking.",
                        improvement: "To reach A+ level, develop your leadership skills and demonstrate more initiative in group contexts."
                    },
                    'upper-second': {
                        strength: "Your work shows good commitment and self-management with consistent professional conduct.",
                        evidence: "Your time management and planning needs improvement, particularly for complex projects. You need to develop more effective strategies for balancing competing priorities and managing setbacks. Your ability to respond constructively to feedback and incorporate it into your work is inconsistent.",
                        improvement: "Work on developing more consistent self-reflection and planning skills to enhance your professional approach."
                    },
                    'lower-second': {
                        strength: "Your work shows satisfactory commitment and self-management with adequate professional conduct.",
                        evidence: "Your professional approach lacks consistency, with evidence of poor planning and time management affecting project outcomes. Your engagement with feedback is superficial, and you struggle to effectively incorporate critiques into your work. In collaborative contexts, your contribution is minimal or inconsistent.",
                        improvement: "Improve your planning and self-management skills, and demonstrate more consistent engagement throughout projects."
                    },
                    'third': {
                        strength: "Your work shows basic commitment and self-management with developing professional conduct.",
                        evidence: "Your approach to planning and time management is significantly underdeveloped, leading to incomplete work or rushed execution. You show limited engagement with the subject beyond minimum requirements. Your ability to work effectively in teams is hampered by poor communication or unreliability.",
                        improvement: "Develop basic planning and organizational strategies, and practice applying them consistently to your work."
                    },
                    'marginal-fail': {
                        strength: "Your work shows limited commitment and poor self-management with minimal professional conduct.",
                        evidence: "Your work demonstrates serious deficiencies in planning and time management, with deadlines frequently missed or work substantially incomplete. There is little evidence of engagement with the subject or feedback. Your approach to collaborative work is problematic, affecting team dynamics or outcomes.",
                        improvement: "Learn fundamental time management and planning techniques and begin to apply them to your work processes."
                    },
                    'fail': {
                        strength: "Your work shows insufficient commitment and self-management with lack of professional conduct.",
                        evidence: "There is almost no evidence of planning or time management in your work. Your engagement with the subject is minimal or absent. You need to develop basic understanding of professional expectations within educational and industry contexts, including reliability, communication, and personal responsibility.",
                        improvement: "Develop basic understanding of professional conduct and time management for academic and design work."
                    }
                }
            }
        ];
        // Grade bands data with step marking
        const gradeBands = [
            { 
                id: 'first-plus', 
                title: 'Distinction', 
                options: [
                    { value: '98%', label: 'High (98%)' },
                    { value: '95%', label: 'Mid (95%)' },
                    { value: '92%', label: 'Low (92%)' }
                ],
                range: '85% and above', 
                quality: 'Outstanding', 
                color: '#80FF80', 
                letterGrade: 'A+' 
            },
            { 
                id: 'first', 
                title: 'First Class', 
                options: [
                    { value: '82%', label: 'High (82%)' },
                    { value: '78%', label: 'Mid (78%)' },
                    { value: '72%', label: 'Low (72%)' }
                ],
                range: '70-84%', 
                quality: 'Very Good', 
                color: '#BFFF80', 
                letterGrade: 'A' 
            },
            { 
                id: 'upper-second', 
                title: 'Upper Second (2:1)', 
                options: [
                    { value: '68%', label: 'High (68%)' },
                    { value: '65%', label: 'Mid (65%)' },
                    { value: '62%', label: 'Low (62%)' }
                ],
                range: '60-69%', 
                quality: 'Good', 
                color: '#FFFF80', 
                letterGrade: 'B' 
            },
            { 
                id: 'lower-second', 
                title: 'Lower Second (2:2)', 
                options: [
                    { value: '58%', label: 'High (58%)' },
                    { value: '55%', label: 'Mid (55%)' },
                    { value: '52%', label: 'Low (52%)' }
                ],
                range: '50-59%', 
                quality: 'Satisfactory', 
                color: '#FFE880', 
                letterGrade: 'C' 
            },
            { 
                id: 'third', 
                title: 'Third Class', 
                options: [
                    { value: '48%', label: 'High (48%)' },
                    { value: '45%', label: 'Mid (45%)' },
                    { value: '42%', label: 'Low (42%)' }
                ],
                range: '40-49%', 
                quality: 'Adequate', 
                color: '#FFCC80', 
                letterGrade: 'D' 
            },
            { 
                id: 'marginal-fail', 
                title: 'Marginal Fail', 
                options: [
                    { value: '38%', label: 'High (38%)' },
                    { value: '35%', label: 'Low (35%)' }
                ],
                range: '35-39%', 
                quality: 'Unsatisfactory', 
                color: '#FF9980', 
                letterGrade: 'FM' 
            },
            { 
                id: 'fail', 
                title: 'Fail', 
                options: [
                    { value: '32%', label: 'High (32%)' },
                    { value: '25%', label: 'Mid (25%)' },
                    { value: '15%', label: 'Low (15%)' }
                ],
                range: '0-34%', 
                quality: 'Poor', 
                color: '#FF8080', 
                letterGrade: 'F' 
            }
        ];
        
        // Overall improvement advice by grade
        const overallImprovements = {
            'fail': [
                'Develop basic understanding of research methods and design processes',
                'Begin to analyze materials rather than just describing them',
                'Improve documentation of your design development process',
                'Show evidence of basic material investigation',
                'Practice fundamental presentation techniques',
                'Develop basic time management and planning skills'
            ],
            'marginal-fail': [
                'Strengthen your research with more diverse sources',
                'Show clearer connections between research and design development',
                'Improve organization and documentation of your design process',
                'Conduct more thorough material investigations',
                'Practice basic presentation techniques for more professional outcomes',
                'Improve your self-management and planning'
            ],
            'third': [
                'Expand your research beyond obvious sources',
                'Develop better analytical skills rather than just describing',
                'Improve organization of your design development process',
                'Conduct more detailed material investigations with clearer evaluation',
                'Show more consistent professionalism in presentation',
                'Demonstrate more consistent engagement throughout projects'
            ],
            'lower-second': [
                'Deepen your research and show stronger critical analysis',
                'Make clearer connections between research and design development',
                'Show more creative exploration in your design process',
                'Enhance material investigations with more thoughtful evaluation',
                'Improve consistency in professional presentation standards',
                'Work on more effective planning and time management'
            ],
            'upper-second': [
                'Extend research beyond expected sources with deeper critical analysis',
                'Show more innovative connections between research and design',
                'Demonstrate more creative exploration and risk-taking',
                'Develop more sophisticated evaluation of materials and applications',
                'Refine presentation techniques for more professional outcomes',
                'Improve self-reflection and engagement with feedback'
            ],
            'first': [
                'Push research to discover unexpected connections and insights',
                'Take more creative risks that result in innovative outcomes',
                'Demonstrate exceptional critical thinking throughout',
                'Perfect technical execution in all aspects',
                'Explore innovative presentation methods while maintaining clarity',
                'Develop leadership skills and initiative in collaborative contexts'
            ],
            'first-plus': [
                'Continue your outstanding work across all learning outcomes',
                'Consider mentoring others to share your exceptional approach',
                'Explore opportunities to showcase your work professionally',
                'Maintain your excellent standard while continuing to innovate',
                'Develop your professional network and industry connections'
            ]
        };
        // Default performance levels
        let performanceLevels = {
            outcome1: { bandId: 'first', percentage: '78%' },
            outcome2: { bandId: 'upper-second', percentage: '65%' },
            outcome3: { bandId: 'lower-second', percentage: '55%' },
            outcome4: { bandId: 'upper-second', percentage: '62%' },
            outcome5: { bandId: 'first', percentage: '72%' },
            outcome6: { bandId: 'upper-second', percentage: '68%' }
        };
        
        // Get DOM elements
        const outcomeContainer = document.getElementById('outcomes-container');
        const performanceChart = document.getElementById('performance-chart');
        const gradeDisplay = document.getElementById('average-grade-display');
        const gradeTitle = document.getElementById('grade-title');
        const numericGrade = document.getElementById('numeric-grade');
        const keyImprovements = document.getElementById('key-improvements');
        const detailedFeedback = document.getElementById('detailed-feedback');
        const overallAdvice = document.getElementById('overall-advice');
        
        // Modal elements
        const matrixModal = document.getElementById('matrix-modal');
        const compareModal = document.getElementById('compare-modal');
        const closeMatrixBtn = document.getElementById('close-matrix');
        const closeMatrixBtn2 = document.getElementById('close-matrix-btn');
        const closeCompareBtn = document.getElementById('close-compare');
        const closeCompareBtn2 = document.getElementById('close-compare-btn');
        
        // Action buttons
        const saveProfileBtn = document.getElementById('save-profile-btn');
        const loadProfileBtn = document.getElementById('load-profile-btn');
        const profileUpload = document.getElementById('profile-upload');
        const compareProfilesBtn = document.getElementById('compare-profiles-btn');
        const printSummaryBtn = document.getElementById('print-summary-btn');
        const matrixButton = document.getElementById('matrix-button');
        
        // Success message
        const successMessage = document.getElementById('success-message');
        
        // Initialize UI
        initializeUI();
        updateAllContent();
        
        // Check for saved profiles
        checkSavedProfiles();
        
        // Set up modal event listeners
        matrixButton.addEventListener('click', () => {
            matrixModal.style.display = 'block';
            matrixModal.setAttribute('aria-hidden', 'false');
            document.getElementById('matrix-title').focus();
            trapFocusInModal(matrixModal);
        });
        
        closeMatrixBtn.addEventListener('click', () => {
            closeMatrixModal();
        });
        
        closeMatrixBtn2.addEventListener('click', () => {
            closeMatrixModal();
        });
        
        compareProfilesBtn.addEventListener('click', () => {
            updateCompareModal();
            compareModal.style.display = 'block';
            compareModal.setAttribute('aria-hidden', 'false');
            document.getElementById('compare-title').focus();
            trapFocusInModal(compareModal);
        });
        
        closeCompareBtn.addEventListener('click', () => {
            closeCompareModal();
        });
        
        closeCompareBtn2.addEventListener('click', () => {
            closeCompareModal();
        });
        
        window.addEventListener('click', (event) => {
            if (event.target === matrixModal) {
                closeMatrixModal();
            }
            if (event.target === compareModal) {
                closeCompareModal();
            }
        });
        
        // Keyboard navigation for modals
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                if (matrixModal.style.display === 'block') {
                    closeMatrixModal();
                }
                if (compareModal.style.display === 'block') {
                    closeCompareModal();
                }
            }
        });
        
        // Set up profile load functionality
        loadProfileBtn.addEventListener('click', () => {
            profileUpload.click();
        });
        
        profileUpload.addEventListener('change', handleProfileUpload);
        
        // Save profile button
        saveProfileBtn.addEventListener('click', saveProfile);
        
        // Print summary button
        printSummaryBtn.addEventListener('click', printSummary);
        // Initialize the UI components
        function initializeUI() {
            // Create outcome inputs
            outcomeContainer.innerHTML = '';
            
            learningOutcomes.forEach(outcome => {
                const outcomeElement = document.createElement('div');
                outcomeElement.className = 'mb-4';
                outcomeElement.style.marginBottom = '20px';
                
                const gradeBandHtml = `
                    <div class="grade-bands-wrapper" role="radiogroup" aria-label="Grade bands for ${outcome.title}">
                        ${gradeBands.map(band => {
                            const isActive = performanceLevels[outcome.id].bandId === band.id;
                            const optionsHtml = band.options.map(option => {
                                const isOptionActive = isActive && performanceLevels[outcome.id].percentage === option.value;
                                // Extract just High, Mid, Low from the label
                                const simplifiedLabel = option.label.split('(')[0].trim();
                                return `
                                    <button 
                                        class="grade-option-btn ${isOptionActive ? 'active' : ''}" 
                                        data-band-id="${band.id}" 
                                        data-outcome-id="${outcome.id}"
                                        data-percentage="${option.value}"
                                        role="radio"
                                        aria-checked="${isOptionActive ? 'true' : 'false'}"
                                        aria-label="${band.title} ${option.label}"
                                    >
                                        ${simplifiedLabel}
                                    </button>
                                `;
                            }).join('');
                            
                            return `
                                <div class="grade-band-container ${isActive ? band.id : ''}" style="background-color: ${isActive ? band.color : '#f9f9f9'};">
                                    <div class="grade-band-title" id="grade-band-${band.id}-${outcome.id}">${band.title}</div>
                                    <div class="grade-options-container">
                                        ${optionsHtml}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
                
                const html = `
                    <h3 id="outcome-title-${outcome.id}" style="font-weight: bold; color: #333; font-size: 0.95rem; margin-bottom: 4px;">${outcome.title}</h3>
                    <p style="font-size: 0.85rem; color: #555; margin-bottom: 5px;">${outcome.description}</p>
                    <p style="font-size: 0.75rem; color: #3b82f6; margin-bottom: 8px;">School of Design Framework Mapping: <strong>${outcome.framework}</strong></p>
                    
                    <div>
                        <label for="grade-selector-${outcome.id}" style="font-size: 0.85rem; font-weight: 600; display: block; margin-bottom: 2px;">Select Your Grade:</label>
                        ${gradeBandHtml}
                    </div>
                `;
                
                outcomeElement.innerHTML = html;
                outcomeContainer.appendChild(outcomeElement);
            });
            
            // Add event listeners to grade option buttons
            document.querySelectorAll('.grade-option-btn').forEach(button => {
                button.addEventListener('click', handleGradeOptionChange);
                
                // Keyboard handling for radio buttons
                button.addEventListener('keydown', (event) => {
                    const outcomeId = button.dataset.outcomeId;
                    const bandId = button.dataset.bandId;
                    const currentBandIndex = gradeBands.findIndex(band => band.id === bandId);
                    
                    if (event.key === 'ArrowRight' || event.key === 'ArrowDown') {
                        event.preventDefault();
                        // Move to next option in same band
                        const siblings = Array.from(button.parentNode.querySelectorAll('.grade-option-btn'));
                        const currentIndex = siblings.indexOf(button);
                        if (currentIndex < siblings.length - 1) {
                            siblings[currentIndex + 1].focus();
                        } else {
                            // Move to first option in next band if available
                            const nextBand = gradeBands[currentBandIndex + 1];
                            if (nextBand) {
                                const nextBandOptions = document.querySelectorAll(`.grade-option-btn[data-band-id="${nextBand.id}"][data-outcome-id="${outcomeId}"]`);
                                if (nextBandOptions.length > 0) {
                                    nextBandOptions[0].focus();
                                }
                            }
                        }
                    } else if (event.key === 'ArrowLeft' || event.key === 'ArrowUp') {
                        event.preventDefault();
                        // Move to previous option in same band
                        const siblings = Array.from(button.parentNode.querySelectorAll('.grade-option-btn'));
                        const currentIndex = siblings.indexOf(button);
                        if (currentIndex > 0) {
                            siblings[currentIndex - 1].focus();
                        } else {
                            // Move to last option in previous band if available
                            const prevBand = gradeBands[currentBandIndex - 1];
                            if (prevBand) {
                                const prevBandOptions = document.querySelectorAll(`.grade-option-btn[data-band-id="${prevBand.id}"][data-outcome-id="${outcomeId}"]`);
                                if (prevBandOptions.length > 0) {
                                    prevBandOptions[prevBandOptions.length - 1].focus();
                                }
                            }
                        }
                    }
                });
            });
        }
        
        // Handle grade option change
        function handleGradeOptionChange(event) {
            const outcomeId = event.target.dataset.outcomeId;
            const bandId = event.target.dataset.bandId;
            const percentage = event.target.dataset.percentage;
            
            // Update performance level
            performanceLevels[outcomeId] = {
                bandId: bandId,
                percentage: percentage
            };
            
            // Update all radio buttons in the outcome group
            const radioGroup = event.target.closest('[role="radiogroup"]');
            radioGroup.querySelectorAll('[role="radio"]').forEach(radio => {
                const isChecked = (radio.dataset.bandId === bandId && radio.dataset.percentage === percentage);
                radio.setAttribute('aria-checked', isChecked ? 'true' : 'false');
                if (isChecked) {
                    radio.classList.add('active');
                } else {
                    radio.classList.remove('active');
                }
            });
            
            // Update UI
            updateUI(outcomeId);
            updateAllContent();
            
            // Announce to screen readers
            announceGradeChange(outcomeId, bandId, percentage);
        }
        
        // Helper function to announce grade changes to screen readers
        function announceGradeChange(outcomeId, bandId, percentage) {
            const outcome = learningOutcomes.find(o => o.id === outcomeId);
            const band = gradeBands.find(b => b.id === bandId);
            
            // Create a live region if it doesn't exist
            let liveRegion = document.getElementById('grade-change-announcement');
            if (!liveRegion) {
                liveRegion = document.createElement('div');
                liveRegion.id = 'grade-change-announcement';
                liveRegion.setAttribute('aria-live', 'polite');
                liveRegion.setAttribute('class', 'sr-only');
                document.body.appendChild(liveRegion);
            }
            
            // Announce the change
            liveRegion.textContent = `${outcome.title} grade changed to ${band.title}, ${percentage}`;
        }
        // Update UI for a specific outcome
        function updateUI(outcomeId) {
            // Update grade band containers
            document.querySelectorAll(`[data-outcome-id="${outcomeId}"]`).forEach(button => {
                // Get parent container
                const bandId = button.dataset.bandId;
                const percentage = button.dataset.percentage;
                const isActive = performanceLevels[outcomeId].bandId === bandId;
                const isOptionActive = isActive && performanceLevels[outcomeId].percentage === percentage;
                
                // Find parent container
                const container = button.closest('.grade-band-container');
                
                // Update container styling
                if (isActive) {
                    const band = gradeBands.find(b => b.id === bandId);
                    container.style.backgroundColor = band.color;
                    container.classList.add(bandId);
                } else {
                    container.style.backgroundColor = '#f9f9f9';
                    gradeBands.forEach(band => {
                        container.classList.remove(band.id);
                    });
                }
                
                // Update button active state
                if (isOptionActive) {
                    button.classList.add('active');
                    button.setAttribute('aria-checked', 'true');
                } else {
                    button.classList.remove('active');
                    button.setAttribute('aria-checked', 'false');
                }
            });
        }
        
        // Update all content based on performance levels
        function updateAllContent() {
            updatePerformanceChart();
            updateAverageGrade();
            updateKeyImprovements();
            updateDetailedFeedback();
            updateOverallAdvice();
        }
        
        // Draw performance chart
        function updatePerformanceChart() {
            const ctx = performanceChart.getContext('2d');
            
            // Clear canvas
            ctx.clearRect(0, 0, performanceChart.width, performanceChart.height);
            
            const centerX = performanceChart.width / 2;
            const centerY = performanceChart.height / 2;
            const radius = Math.min(centerX, centerY) - 40;
            
            // Draw axes
            const numAxes = learningOutcomes.length;
            const angleStep = (Math.PI * 2) / numAxes;
            
            // Draw concentric circles for grade levels
            const gradeLevels = gradeBands.length;
            const radiusStep = radius / gradeLevels;
            
            // Draw grade level circles
            for (let i = 1; i <= gradeLevels; i++) {
                const levelRadius = radiusStep * i;
                ctx.beginPath();
                ctx.arc(centerX, centerY, levelRadius, 0, Math.PI * 2);
                ctx.strokeStyle = i === gradeLevels ? '#333' : '#ddd';
                ctx.stroke();
                
                // Label the grade level - only on the top
                if (i < gradeLevels) {
                    const grade = gradeBands[gradeLevels - i - 1];
                    ctx.fillStyle = '#666';
                    ctx.font = '10px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(grade.title.split(' ')[0], centerX, centerY - levelRadius - 5);
                }
            }
            
            // Draw axes
            for (let i = 0; i < numAxes; i++) {
                const angle = i * angleStep - Math.PI / 2;
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);
                
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.strokeStyle = '#aaa';
                ctx.stroke();
                
                // Label the axis with just the LO number
                const labelX = centerX + (radius + 20) * Math.cos(angle);
                const labelY = centerY + (radius + 20) * Math.sin(angle);
                
                ctx.fillStyle = '#333';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                // Just use LO1, LO2, etc.
                ctx.fillText(`LO${i+1}`, labelX, labelY);
            }
            
            // Plot data points
            const dataPoints = [];
            
            for (let i = 0; i < numAxes; i++) {
                const outcome = learningOutcomes[i];
                const gradeId = performanceLevels[outcome.id].bandId;
                const gradeIndex = gradeBands.findIndex(g => g.id === gradeId);
                
                // Reverse the index since highest grades are on the outside
                const reversedIndex = gradeBands.length - gradeIndex - 1;
                
                const pointRadius = radiusStep * (reversedIndex + 0.5);
                const angle = i * angleStep - Math.PI / 2;
                const x = centerX + pointRadius * Math.cos(angle);
                const y = centerY + pointRadius * Math.sin(angle);
                
                dataPoints.push({ x, y });
            }
            
            // Draw the shape
            ctx.beginPath();
            ctx.moveTo(dataPoints[0].x, dataPoints[0].y);
            
            for (let i = 1; i < dataPoints.length; i++) {
                ctx.lineTo(dataPoints[i].x, dataPoints[i].y);
            }
            
            ctx.lineTo(dataPoints[0].x, dataPoints[0].y);
            ctx.fillStyle = 'rgba(59, 130, 246, 0.3)';
            ctx.fill();
            ctx.strokeStyle = 'rgba(59, 130, 246, 0.8)';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Draw data points
            dataPoints.forEach((point, index) => {
                const outcome = learningOutcomes[index];
                const gradeId = performanceLevels[outcome.id].bandId;
                const grade = gradeBands.find(g => g.id === gradeId);
                
                ctx.beginPath();
                ctx.arc(point.x, point.y, 6, 0, Math.PI * 2);
                ctx.fillStyle = grade.color;
                ctx.fill();
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 1;
                ctx.stroke();
            });
        }
        // Calculate and update average grade
        function updateAverageGrade() {
            // Convert percentage strings to numbers
            const percentages = Object.values(performanceLevels).map(level => 
                parseFloat(level.percentage.replace('%', ''))
            );
            
            // Calculate simple average
            const average = percentages.reduce((sum, val) => sum + val, 0) / percentages.length;
            
            // Round to nearest step mark (X8, X5, X2, X0)
            let roundedAverage;
            if (average % 10 <= 1) roundedAverage = Math.floor(average / 10) * 10;
            else if (average % 10 <= 3.5) roundedAverage = Math.floor(average / 10) * 10 + 2;
            else if (average % 10 <= 6.5) roundedAverage = Math.floor(average / 10) * 10 + 5;
            else if (average % 10 <= 9) roundedAverage = Math.floor(average / 10) * 10 + 8;
            else roundedAverage = Math.ceil(average / 10) * 10;
            
            // Find grade band
            let gradeBand = null;
            for (const band of gradeBands) {
                const rangeNums = band.options.map(o => parseFloat(o.value.replace('%', '')));
                const minRange = Math.min(...rangeNums);
                const maxRange = Math.max(...rangeNums);
                
                // Special handling for first-plus (85 and above)
                if (band.id === 'first-plus' && roundedAverage >= 85) {
                    gradeBand = band;
                    break;
                } 
                // For other bands, check if within range
                else if (band.id !== 'first-plus') {
                    const rangeText = band.range.split('-');
                    if (rangeText.length === 2) {
                        const min = parseInt(rangeText[0]);
                        const max = parseInt(rangeText[1]);
                        if (roundedAverage >= min && roundedAverage <= max) {
                            gradeBand = band;
                            break;
                        }
                    }
                }
            }
            
            if (gradeBand) {
                // Update grade display
                gradeDisplay.className = '';
                gradeDisplay.classList.add(gradeBand.id);
                gradeDisplay.style.backgroundColor = gradeBand.color;
                
                // Update with only title and percentage (no letter grade)
                gradeTitle.textContent = gradeBand.title;
                numericGrade.textContent = `${roundedAverage}%`;
                
                // Update ARIA attributes for accessibility
                gradeDisplay.setAttribute('aria-label', `Your average grade is ${roundedAverage}%, which is a ${gradeBand.title}`);
            }
        }
        
        // Update key improvements
        function updateKeyImprovements() {
            keyImprovements.innerHTML = '';
            
            learningOutcomes.forEach(outcome => {
                const feedback = outcome.feedback[performanceLevels[outcome.id].bandId];
                
                const li = document.createElement('li');
                li.innerHTML = `<span style="font-weight: 600;">${outcome.title.split(':')[0]}:</span> ${feedback.improvement}`;
                keyImprovements.appendChild(li);
            });
        }
        
        // Update detailed feedback
        function updateDetailedFeedback() {
            detailedFeedback.innerHTML = '';
            
            learningOutcomes.forEach(outcome => {
                const gradeInfo = performanceLevels[outcome.id];
                const grade = gradeBands.find(g => g.id === gradeInfo.bandId);
                const feedback = outcome.feedback[gradeInfo.bandId];
                
                const card = document.createElement('div');
                card.className = 'bg-white p-4 rounded-md shadow-sm';
                card.style.backgroundColor = 'white';
                card.style.padding = '16px';
                card.style.borderRadius = '2px';
                card.style.boxShadow = '0 1px 2px rgba(0,0,0,0.05)';
                
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px;">
                        <h3 style="font-weight: bold;">${outcome.title}</h3>
                        <div style="display: flex; flex-direction: column; align-items: flex-end;">
                            <span 
                                style="padding: 4px 8px; border-radius: 2px; font-size: 0.875rem; font-weight: bold; margin-bottom: 4px; background-color: ${grade.color};"
                            >
                                ${grade.title}
                            </span>
                        </div>
                    </div>
                    
                    <div style="font-size: 0.875rem;">
                        <div style="margin-bottom: 8px;">
                            <p class="section-title">Strengths Evidenced in Your Work:</p>
                            <p>${feedback.strength}</p>
                        </div>
                        <div style="margin-bottom: 8px;">
                            <p class="section-title">Areas for Reflection and Practice:</p>
                            <p>${feedback.evidence}</p>
                        </div>
                        <div>
                            <p class="section-title">Summary:</p>
                            <p>${feedback.improvement}</p>
                        </div>
                    </div>
                `;
                
                detailedFeedback.appendChild(card);
            });
        }
        
        // Update overall advice
        function updateOverallAdvice() {
            // Calculate average grade to determine advice level
            const percentages = Object.values(performanceLevels).map(level => 
                parseFloat(level.percentage.replace('%', ''))
            );
            
            const average = percentages.reduce((sum, val) => sum + val, 0) / percentages.length;
            
            // Find grade band
            let gradeBandId = null;
            for (const band of gradeBands) {
                // Special handling for first-plus
                if (band.id === 'first-plus' && average >= 85) {
                    gradeBandId = band.id;
                    break;
                } 
                // For other bands
                else if (band.id !== 'first-plus') {
                    const rangeText = band.range.split('-');
                    if (rangeText.length === 2) {
                        const min = parseInt(rangeText[0]);
                        const max = parseInt(rangeText[1]);
                        if (average >= min && average <= max) {
                            gradeBandId = band.id;
                            break;
                        }
                    }
                }
            }
            
            if (gradeBandId && overallImprovements[gradeBandId]) {
                overallAdvice.innerHTML = '';
                
                overallImprovements[gradeBandId].forEach(advice => {
                    const li = document.createElement('li');
                    li.textContent = advice;
                    overallAdvice.appendChild(li);
                });
            }
        }
        // Save the current profile as a downloadable JSON file with student name
        function saveProfile() {
            // Get student name
            const studentNameInput = document.getElementById('student-name');
            const studentName = studentNameInput.value.trim() || 'Anonymous Student';
            
            // Create a profile object
            const now = new Date();
            const dateString = now.toISOString().slice(0, 10);
            const timeString = now.toTimeString().slice(0, 5);
            
            // Calculate average grade for the profile
            const percentages = Object.values(performanceLevels).map(level => 
                parseFloat(level.percentage.replace('%', ''))
            );
            
            const average = percentages.reduce((sum, val) => sum + val, 0) / percentages.length;
            
            // Round to nearest step mark (X8, X5, X2, X0)
            let roundedAverage;
            if (average % 10 <= 1) roundedAverage = Math.floor(average / 10) * 10;
            else if (average % 10 <= 3.5) roundedAverage = Math.floor(average / 10) * 10 + 2;
            else if (average % 10 <= 6.5) roundedAverage = Math.floor(average / 10) * 10 + 5;
            else if (average % 10 <= 9) roundedAverage = Math.floor(average / 10) * 10 + 8;
            else roundedAverage = Math.ceil(average / 10) * 10;
            
            // Find grade band
            let gradeBandId = null;
            let gradeBandTitle = '';
            let letterGrade = '';
            
            for (const band of gradeBands) {
                // Special handling for first-plus
                if (band.id === 'first-plus' && roundedAverage >= 85) {
                    gradeBandId = band.id;
                    gradeBandTitle = band.title;
                    letterGrade = band.letterGrade;
                    break;
                } 
                // For other bands
                else if (band.id !== 'first-plus') {
                    const rangeText = band.range.split('-');
                    if (rangeText.length === 2) {
                        const min = parseInt(rangeText[0]);
                        const max = parseInt(rangeText[1]);
                        if (roundedAverage >= min && roundedAverage <= max) {
                            gradeBandId = band.id;
                            gradeBandTitle = band.title;
                            letterGrade = band.letterGrade;
                            break;
                        }
                    }
                }
            }
            
            const profile = {
                id: `profile-${Date.now()}`,
                studentName: studentName,
                date: `${dateString} ${timeString}`,
                performanceLevels: {...performanceLevels},
                averageGrade: {
                    bandId: gradeBandId,
                    bandTitle: gradeBandTitle,
                    numericValue: roundedAverage,
                    letterGrade: letterGrade
                }
            };
            
            // Get existing profiles from localStorage
            let existingProfiles = [];
            try {
                const storedProfiles = localStorage.getItem('fn4004-assessment-profiles');
                if (storedProfiles) {
                    existingProfiles = JSON.parse(storedProfiles);
                }
            } catch (error) {
                console.error('Error loading saved profiles:', error);
            }
            
            // Add new profile and save to localStorage
            const updatedProfiles = [profile, ...existingProfiles].slice(0, 10); // Keep only 10 most recent
            localStorage.setItem('fn4004-assessment-profiles', JSON.stringify(updatedProfiles));
            
            // Also save as downloadable file
            const dataStr = JSON.stringify(profile, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `FN4004_Assessment_Profile_${dateString.replace(/-/g, '')}_${studentName.replace(/\s+/g, '_')}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.style.display = 'none';
            document.body.appendChild(linkElement);
            linkElement.click();
            document.body.removeChild(linkElement);
            
            // Show success message with student name
            successMessage.style.display = 'block';
            const messagePara = successMessage.querySelector('p');
            if (messagePara) {
                messagePara.textContent = `Assessment Profile Saved for ${studentName}!`;
            }
            
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 3000);
            
            // Enable compare button
            compareProfilesBtn.disabled = false;
            compareProfilesBtn.style.opacity = '1';
            compareProfilesBtn.setAttribute('aria-disabled', 'false');
            
            // Announce to screen readers
            announceProfileSaved(exportFileDefaultName, studentName);
        }
        
        // Helper function to announce profile saving to screen readers
        function announceProfileSaved(filename, studentName) {
            // Create a live region if it doesn't exist
            let liveRegion = document.getElementById('profile-save-announcement');
            if (!liveRegion) {
                liveRegion = document.createElement('div');
                liveRegion.id = 'profile-save-announcement';
                liveRegion.setAttribute('aria-live', 'polite');
                liveRegion.setAttribute('class', 'sr-only');
                document.body.appendChild(liveRegion);
            }
            
            // Announce the save
            liveRegion.textContent = `Assessment profile for ${studentName} saved successfully as ${filename}. You can now upload this file to your OneDrive to keep track of your progress.`;
        }
        // Check for saved profiles
        function checkSavedProfiles() {
            try {
                const storedProfiles = localStorage.getItem('fn4004-assessment-profiles');
                if (storedProfiles) {
                    const profiles = JSON.parse(storedProfiles);
                    if (profiles.length > 0) {
                        compareProfilesBtn.disabled = false;
                        compareProfilesBtn.style.opacity = '1';
                        compareProfilesBtn.setAttribute('aria-disabled', 'false');
                    }
                }
            } catch (error) {
                console.error('Error loading saved profiles:', error);
            }
        }
        
        // Handle profile upload functionality
        function handleProfileUpload(event) {
            const fileReader = new FileReader();
            const file = event.target.files[0];
            
            if (!file) return;
            
            fileReader.onload = (e) => {
                try {
                    // Parse the file content
                    const profileData = JSON.parse(e.target.result);
                    
                    // Validate the profile data structure
                    if (!isValidProfile(profileData)) {
                        throw new Error('Invalid profile format');
                    }
                    
                    // Update the student name field if available in the profile
                    if (profileData.studentName) {
                        document.getElementById('student-name').value = profileData.studentName;
                    }
                    
                    // Get existing profiles
                    let existingProfiles = [];
                    try {
                        const storedProfiles = localStorage.getItem('fn4004-assessment-profiles');
                        if (storedProfiles) {
                            existingProfiles = JSON.parse(storedProfiles);
                        }
                    } catch (error) {
                        console.error('Error loading saved profiles:', error);
                        existingProfiles = [];
                    }
                    
                    // Check if this profile already exists in localStorage
                    const profileExists = existingProfiles.some(p => p.id === profileData.id);
                    
                    if (!profileExists) {
                        // Add the loaded profile to localStorage
                        const updatedProfiles = [profileData, ...existingProfiles].slice(0, 10); // Keep only 10 most recent
                        localStorage.setItem('fn4004-assessment-profiles', JSON.stringify(updatedProfiles));
                        
                        // Enable compare button
                        compareProfilesBtn.disabled = false;
                        compareProfilesBtn.style.opacity = '1';
                        compareProfilesBtn.setAttribute('aria-disabled', 'false');
                        
                        // Show success message
                        successMessage.style.display = 'block';
                        const messagePara = successMessage.querySelector('p');
                        if (messagePara) {
                            messagePara.textContent = 'Previous Assessment Profile Loaded!';
                        }
                        
                        setTimeout(() => {
                            successMessage.style.display = 'none';
                        }, 3000);
                        
                        // Announce to screen readers
                        announceProfileLoaded(file.name);
                    } else {
                        alert('This profile is already in your saved profiles.');
                    }
                } catch (error) {
                    console.error('Error loading profile:', error);
                    alert('Could not load profile. Please ensure this is a valid assessment profile file.');
                }
                
                // Reset the file input
                profileUpload.value = '';
            };
            
            fileReader.readAsText(file);
        }
        
        // Helper function to validate profile structure
        function isValidProfile(profile) {
            // Check if the profile has the required properties
            if (!profile.id || !profile.date || !profile.performanceLevels || !profile.averageGrade) {
                return false;
            }
            
            // Check if performanceLevels contains data for all learning outcomes
            const requiredOutcomes = ['outcome1', 'outcome2', 'outcome3', 'outcome4', 'outcome5', 'outcome6'];
            for (const outcome of requiredOutcomes) {
                if (!profile.performanceLevels[outcome] ||
                    !profile.performanceLevels[outcome].bandId ||
                    !profile.performanceLevels[outcome].percentage) {
                    return false;
                }
            }
            
            // Check if averageGrade contains required properties
            if (!profile.averageGrade.bandId ||
                !profile.averageGrade.bandTitle ||
                !profile.averageGrade.numericValue) {
                return false;
            }
            
            return true;
        }
        
        // Helper function to announce profile loading to screen readers
        function announceProfileLoaded(filename) {
            // Create a live region if it doesn't exist
            let liveRegion = document.getElementById('profile-load-announcement');
            if (!liveRegion) {
                liveRegion = document.createElement('div');
                liveRegion.id = 'profile-load-announcement';
                liveRegion.setAttribute('aria-live', 'polite');
                liveRegion.setAttribute('class', 'sr-only');
                document.body.appendChild(liveRegion);
            }
            
            // Announce the load
            liveRegion.textContent = `Previous assessment profile ${filename} loaded successfully. You can now compare your current assessment with this previous one.`;
        }
        // Update compare modal with fixed comparison logic
        function updateCompareModal() {
            const hasProfilesDiv = document.getElementById('has-profiles');
            const noProfilesDiv = document.getElementById('no-profiles');
            const progressTable = document.getElementById('progress-table');
            const improvementList = document.getElementById('improvement-list');
            const previousDate = document.getElementById('previous-date');
            
            try {
                const storedProfiles = localStorage.getItem('fn4004-assessment-profiles');
                if (storedProfiles) {
                    const profiles = JSON.parse(storedProfiles);
                    if (profiles.length > 0) {
                        // Show profiles content
                        hasProfilesDiv.style.display = 'block';
                        noProfilesDiv.style.display = 'none';
                        
                        // Create progress table with improved accessibility
                        let tableHtml = `
                            <caption class="sr-only">Progress over time showing grade improvements across learning outcomes</caption>
                            <thead>
                                <tr>
                                    <th scope="col">Student</th>
                                    <th scope="col">Date</th>
                                    <th scope="col">Average Grade</th>
                                    ${learningOutcomes.map(outcome => 
                                        `<th scope="col">${outcome.title.split(':')[0]}</th>`
                                    ).join('')}
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                        `;
                        
                        // Calculate current average
                        const percentages = Object.values(performanceLevels).map(level => 
                            parseFloat(level.percentage.replace('%', ''))
                        );
                        
                        const average = percentages.reduce((sum, val) => sum + val, 0) / percentages.length;
                        
                        // Round to nearest percentage
                        let roundedAverage = Math.round(average);
                        
                        // Find band title
                        let bandTitle = '';
                        for (const band of gradeBands) {
                            if (band.id === 'first-plus' && roundedAverage >= 85) {
                                bandTitle = band.title;
                                break;
                            } else if (band.id !== 'first-plus') {
                                const rangeText = band.range.split('-');
                                if (rangeText.length === 2) {
                                    const min = parseInt(rangeText[0]);
                                    const max = parseInt(rangeText[1]);
                                    if (roundedAverage >= min && roundedAverage <= max) {
                                        bandTitle = band.title;
                                        break;
                                    }
                                }
                            }
                        }
                        
                        // Get student name
                        const studentName = document.getElementById('student-name').value.trim() || 'Anonymous Student';
                        
                        tableHtml += `
                                    <td>${studentName}</td>
                                    <td>Current</td>
                                    <td>${roundedAverage}% (${bandTitle})</td>
                        `;
                        
                        // Add outcome grades for current assessment
                        for (const outcome of learningOutcomes) {
                            const gradeInfo = performanceLevels[outcome.id];
                            const percentage = parseFloat(gradeInfo.percentage);
                            const color = gradeBands.find(b => b.id === gradeInfo.bandId).color;
                            
                            tableHtml += `
                                <td style="text-align: center; background-color: ${color};">
                                    ${Math.round(percentage)}%
                                </td>
                            `;
                        }
                        
                        tableHtml += `</tr>`;
                        
                        // Add saved profiles
                        profiles.forEach(profile => {
                            const profileName = profile.studentName || 'Anonymous Student';
                            const profileDate = profile.date;
                            const avgGrade = profile.averageGrade.numericValue;
                            const avgTitle = profile.averageGrade.bandTitle;
                            
                            tableHtml += `
                                <tr>
                                    <td>${profileName}</td>
                                    <td>${profileDate}</td>
                                    <td>${avgGrade}% (${avgTitle})</td>
                            `;
                            
                            // Add outcome grades
                            for (const outcome of learningOutcomes) {
                                const levelInfo = profile.performanceLevels[outcome.id];
                                if (levelInfo) {
                                    const percentage = parseFloat(levelInfo.percentage);
                                    const color = gradeBands.find(b => b.id === levelInfo.bandId).color;
                                    
                                    tableHtml += `
                                        <td style="text-align: center; background-color: ${color};">
                                            ${Math.round(percentage)}%
                                        </td>
                                    `;
                                } else {
                                    tableHtml += `<td></td>`;
                                }
                            }
                            
                            tableHtml += `</tr>`;
                        });
                        
                        tableHtml += `</tbody>`;
                        progressTable.innerHTML = tableHtml;
                        
                        // Create improvement analysis with fixed comparison
                        if (profiles.length > 0) {
                            const mostRecentProfile = profiles[0];
                            previousDate.textContent = `Compared to previous assessment (${mostRecentProfile.date}):`;
                            
                            improvementList.innerHTML = '';
                            
                            // Create bullet points with learning outcome comparisons
                            learningOutcomes.forEach((outcome, index) => {
                                const currentValue = performanceLevels[outcome.id].percentage;
                                const currentPercentage = parseFloat(currentValue);
                                const previousValue = mostRecentProfile.performanceLevels[outcome.id]?.percentage;
                                const previousPercentage = previousValue ? parseFloat(previousValue) : 0;
                                const difference = Math.round((currentPercentage - previousPercentage) * 10) / 10;
                                
                                // Create list item
                                const li = document.createElement('li');
                                li.innerHTML = `<strong>${outcome.title.split(':')[0]}:</strong> `;
                                
                                // Add appropriate text based on difference
                                if (Math.abs(difference) < 0.1) {
                                    li.innerHTML += '<span class="improvement-neutral">unchanged</span>';
                                } else if (difference > 0) {
                                    li.innerHTML += `<span class="improvement-positive">improved by ${difference}%</span>`;
                                } else {
                                    li.innerHTML += `<span class="improvement-negative">decreased by ${Math.abs(difference)}%</span>`;
                                }
                                
                                improvementList.appendChild(li);
                            });
                            
                            // Overall grade comparison
                            const currentAvg = roundedAverage;
                            const previousAvg = mostRecentProfile.averageGrade.numericValue;
                            const difference = Math.round((currentAvg - previousAvg) * 10) / 10;
                            
                            const li = document.createElement('li');
                            li.style.fontWeight = 'bold';
                            li.style.marginTop = '10px';
                            li.innerHTML = `<strong>Overall grade:</strong> `;
                            
                            if (Math.abs(difference) < 0.1) {
                                li.innerHTML += '<span class="improvement-neutral">unchanged</span>';
                            } else if (difference > 0) {
                                li.innerHTML += `<span class="improvement-positive">improved by ${difference}%</span>`;
                            } else {
                                li.innerHTML += `<span class="improvement-negative">decreased by ${Math.abs(difference)}%</span>`;
                            }
                            
                            improvementList.appendChild(li);
                        }
                    } else {
                        // No profiles
                        hasProfilesDiv.style.display = 'none';
                        noProfilesDiv.style.display = 'block';
                    }
                } else {
                    // No profiles
                    hasProfilesDiv.style.display = 'none';
                    noProfilesDiv.style.display = 'block';
                }
            } catch (error) {
                console.error('Error loading saved profiles:', error);
                // No profiles
                hasProfilesDiv.style.display = 'none';
                noProfilesDiv.style.display = 'block';
            }
        }
        // Print assessment summary with enhanced comparison data and matrix on back page
        function printSummary() {
            const printWindow = window.open('', '_blank');
            
            if (!printWindow) {
                alert('Please allow pop-ups to print the assessment summary.');
                return;
            }
            
            // Get student name
            const studentNameInput = document.getElementById('student-name');
            const studentName = studentNameInput.value.trim() || 'Anonymous Student';
            
            // Calculate average grade
            const percentages = Object.values(performanceLevels).map(level => 
                parseFloat(level.percentage.replace('%', ''))
            );
            
            const average = percentages.reduce((sum, val) => sum + val, 0) / percentages.length;
            
            // Round to nearest step mark
            let roundedAverage = Math.round(average);
            
            // Find grade band
            let gradeBandId = null;
            let gradeBandTitle = '';
            let letterGrade = '';
            
            for (const band of gradeBands) {
                // Special handling for first-plus
                if (band.id === 'first-plus' && roundedAverage >= 85) {
                    gradeBandId = band.id;
                    gradeBandTitle = band.title;
                    letterGrade = band.letterGrade;
                    break;
                } 
                // For other bands
                else if (band.id !== 'first-plus') {
                    const rangeText = band.range.split('-');
                    if (rangeText.length === 2) {
                        const min = parseInt(rangeText[0]);
                        const max = parseInt(rangeText[1]);
                        if (roundedAverage >= min && roundedAverage <= max) {
                            gradeBandId = band.id;
                            gradeBandTitle = band.title;
                            letterGrade = band.letterGrade;
                            break;
                        }
                    }
                }
            }
            
            // Capture current canvas data for printing
            const chartDataURL = performanceChart.toDataURL('image/png');
            
            // Create print content - Using landscape orientation and simplified layout for A4
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>FN4004 Assessment Summary - ${studentName}</title>
                    <style>
                        @page {
                            size: A4 landscape;
                            margin: 1cm;
                        }
                        body {
                            font-family: Arial, sans-serif;
                            padding: 0;
                            margin: 0;
                            line-height: 1.5;
                        }
                        .page {
                            page-break-after: always;
                            position: relative;
                            width: 100%;
                            height: 100%;
                        }
                        .header {
                            text-align: center;
                            margin-bottom: 10px;
                            padding-bottom: 10px;
                            border-bottom: 1px solid #ccc;
                        }
                        .two-column {
                            display: flex;
                            flex-direction: row;
                            justify-content: space-between;
                            gap: 20px;
                        }
                        .column {
                            width: 48%;
                        }
                        .chart-container {
                            text-align: center;
                            margin: 10px 0;
                        }
                        .summary-box {
                            text-align: center;
                            margin-bottom: 10px;
                        }
                        .average-grade {
                            font-size: 24px;
                            font-weight: bold;
                            margin: 10px 0;
                        }
                        .improvements {
                            margin-top: 10px;
                        }
                        h2 {
                            color: #333;
                            margin-top: 10px;
                            margin-bottom: 5px;
                            font-size: 16px;
                        }
                        h3 {
                            color: #333;
                            margin-top: 8px;
                            margin-bottom: 5px;
                            font-size: 14px;
                        }
                        ul {
                            padding-left: 20px;
                            margin-top: 5px;
                            margin-bottom: 5px;
                        }
                        li {
                            margin-bottom: 3px;
                            font-size: 12px;
                        }
                        .footer {
                            font-size: 10px;
                            text-align: center;
                            margin-top: 10px;
                            color: #666;
                            position: absolute;
                            bottom: 0;
                            width: 100%;
                        }
                        /* Matrix table for back page */
                        .matrix-table {
                            width: 100%;
                            border-collapse: collapse;
                            font-size: 9px;
                            margin-top: 10px;
                        }
                        .matrix-table th, .matrix-table td {
                            border: 1px solid #ddd;
                            padding: 5px;
                            text-align: left;
                            vertical-align: top;
                        }
                        .matrix-table th:first-child {
                            background-color: #f1f1f1;
                            font-weight: bold;
                            width: 20%;
                        }
                        .matrix-table tr:first-child th {
                            text-align: center;
                            padding: 5px;
                            color: black;
                            font-weight: bold;
                        }
                        .first-plus { background-color: #80FF80; }
                        .first { background-color: #BFFF80; }
                        .upper-second { background-color: #FFFF80; }
                        .lower-second { background-color: #FFE880; }
                        .third { background-color: #FFCC80; }
                        .marginal-fail { background-color: #FF9980; }
                        .fail { background-color: #FF8080; }
                    </style>
                </head>
                <body>
                    <!-- Page 1: Assessment Summary -->
                    <div class="page">
                        <div class="header">
                            <h1>FN4004 Design Process 1 - Assessment Profile</h1>
                            <p>${studentName} | Generated: ${new Date().toLocaleString()}</p>
                        </div>
                        
                        <div class="two-column">
                            <div class="column">
                                <div class="summary-box">
                                    <h2>Overall Assessment</h2>
                                    <div class="average-grade" style="background-color: ${gradeBands.find(b => b.id === gradeBandId).color}; padding: 10px;">
                                        ${roundedAverage}% - ${gradeBandTitle}
                                    </div>
                                </div>
                                
                                <div class="chart-container">
                                    <img src="${chartDataURL}" alt="Performance radar chart" style="max-width: 100%; height: auto;">
                                </div>
                                
                                <div>
                                    <h3>Learning Outcomes:</h3>
                                    <ul style="font-size: 11px; list-style-type: none; padding-left: 0; columns: 2;">
                                        ${learningOutcomes.map((outcome, i) => 
                                            `<li><strong>LO${i+1}:</strong> ${outcome.title.split(':')[1].trim()}</li>`
                                        ).join('')}
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="column">
                                <div class="improvements">
                                    <h2>How to improve your overall grade:</h2>
                                    
                                    <h3>Key Areas for Improvement:</h3>
                                    <ul>
                                        ${learningOutcomes.map(outcome => {
                                            const feedback = outcome.feedback[performanceLevels[outcome.id].bandId];
                                            return `<li><strong>${outcome.title.split(':')[0]}:</strong> ${feedback.improvement}</li>`;
                                        }).join('')}
                                    </ul>
                                    
                                    <h3>Overall Recommendations:</h3>
                                    <ul>
                                        ${overallImprovements[gradeBandId]?.map(advice =>
                                            `<li>${advice}</li>`
                                        ).join('') || ''}
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="footer">
                            <p>This assessment summary is for reference only and not an official grade. Page 1 of 2</p>
                            <p>Kingston School of Art - BA (Hons) Fashion Program – FN4004 Design Process 1</p>
                            <p>© ${new Date().getFullYear()} Kingston University</p>
                        </div>
                    </div>
                    
                    <!-- Page 2: Grade Descriptor Matrix -->
                    <div class="page">
                        <div class="header">
                            <h1>FN4004 Complete Grade Descriptor Matrix</h1>
                            <p>${studentName} | Generated: ${new Date().toLocaleString()}</p>
                        </div>
                        
                        <table class="matrix-table">
                            <thead>
                                <tr>
                                    <th scope="col">Learning Outcomes</th>
                                    <th scope="col" class="first-plus">Distinction<br>85-100%</th>
                                    <th scope="col" class="first">First Class<br>70-84%</th>
                                    <th scope="col" class="upper-second">Upper Second (2:1)<br>60-69%</th>
                                    <th scope="col" class="lower-second">Lower Second (2:2)<br>50-59%</th>
                                    <th scope="col" class="third">Third Class<br>40-49%</th>
                                    <th scope="col" class="marginal-fail">Marginal Fail<br>35-39%</th>
                                    <th scope="col" class="fail">Fail<br>0-34%</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th scope="row">LO1:<br>Use research sources as a basis for creative design by exploring, evaluating and originating ideas into contemporary fashion concepts.</th>
                                    <td>Outstanding and exceptional use of research sources that go far beyond requirements; highly original thinking.</td>
                                    <td>Excellent use of research sources showing deep understanding and creative application to design development.</td>
                                    <td>Good ability to use research sources with solid evaluation and critical thinking skills.</td>
                                    <td>Satisfactory use of research sources with some evidence of evaluation.</td>
                                    <td>Basic understanding of research sources with limited application to design.</td>
                                    <td>Limited understanding of how to use research sources for design development.</td>
                                    <td>Very little evidence of research informing design work.</td>
                                </tr>
                                <tr>
                                    <th scope="row">LO2:<br>Creatively generate, collate and record information appropriate to the design development process.</th>
                                    <td>Exceptional creativity and innovation in generating and documenting design development with expert organization.</td>
                                    <td>Excellent ability to confidently generate creative ideas and record them effectively through the design process.</td>
                                    <td>Good confidence in generating and recording design ideas with clear progression.</td>
                                    <td>Satisfactory ability to generate and record design information with some creative elements.</td>
                                    <td>Basic ability to generate and record design ideas with minimal organization.</td>
                                    <td>Limited ability to generate or record design information effectively.</td>
                                    <td>Insufficient evidence of generating or recording design information.</td>
                                </tr>
                                <tr>
                                    <th scope="row">LO3:<br>Demonstrate an understanding of material qualities and evaluate their application and appropriateness to design outcomes.</th>
                                    <td>Outstanding understanding of materials with exceptional evaluation skills for innovative applications.</td>
                                    <td>Excellent understanding of material qualities with very good evaluation skills for design outcomes.</td>
                                    <td>Good understanding of material qualities with solid evaluation of their design applications.</td>
                                    <td>Satisfactory understanding of materials with some evaluation of their design applications.</td>
                                    <td>Basic understanding of materials with limited evaluation of their design applications.</td>
                                    <td>Limited understanding of materials with very little evaluation.</td>
                                    <td>Very little evidence of material understanding or evaluation.</td>
                                </tr>
                                <tr>
                                    <th scope="row">LO4:<br>Advance research into creative concepts that recognise historical and/or ethical and social considerations.</th>
                                    <td>Exceptional ability to research creative concepts with outstanding recognition of complex historical, ethical, and social contexts.</td>
                                    <td>Excellent research into creative concepts with strong historical, ethical, and social awareness.</td>
                                    <td>Good research with clear recognition of historical and ethical considerations.</td>
                                    <td>Satisfactory research with some recognition of historical and ethical considerations.</td>
                                    <td>Basic research with limited recognition of historical or ethical considerations.</td>
                                    <td>Limited research with minimal recognition of historical or ethical considerations.</td>
                                    <td>Very little evidence of research into historical or ethical considerations.</td>
                                </tr>
                                <tr>
                                    <th scope="row">LO5:<br>Communicate design outcomes using a variety of traditional and contemporary methods appropriate to professional contexts.</th>
                                    <td>Outstanding communication of design outcomes using exceptionally skilled and innovative methods suitable for professional contexts.</td>
                                    <td>Excellent communication of design outcomes using highly skilled traditional and contemporary methods.</td>
                                    <td>Good communication of design outcomes with skillful use of appropriate methods.</td>
                                    <td>Satisfactory communication of design outcomes using appropriate methods.</td>
                                    <td>Basic communication of design outcomes with limited method variety.</td>
                                    <td>Limited ability to communicate design outcomes effectively.</td>
                                    <td>Very little evidence of ability to communicate design outcomes.</td>
                                </tr>
                                <tr>
                                    <th scope="row">LO6:<br>Personal & Professional Development: Planning, time-management, commitment & subject engagement</th>
                                    <td>Integration of own identity in real or simulated work/subject contexts. Can work highly productively individually, in a team or in a leadership role.</td>
                                    <td>Takes full responsibility for own learning understanding subject possibilities and requirements. Can work comfortably independently, in a team or as a leader.</td>
                                    <td>Self-directed reflection and planning process clearly evidenced in the development of work and context of subject possibilities. Works well alone or in a collaborative team.</td>
                                    <td>Actively working to develop understanding of subject and use process of reflection and effective planning to improve work. Productive working alone or in a team.</td>
                                    <td>Evidence in awareness of subject and strengths, may lack consistency in applying reflection and planning. Able to work alone or collaboratively.</td>
                                    <td>Limited awareness of subject, personal strengths or evidence of reflection or planning and application.</td>
                                    <td>Little or no awareness of subject, personal strengths or evidence of reflection or planning and application.</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div class="footer">
                            <p>This assessment summary is for reference only and not an official grade. Page 2 of 2</p>
                            <p>Kingston School of Art - BA (Hons) Fashion Program – FN4004 Design Process 1</p>
                            <p>© ${new Date().getFullYear()} Kingston University</p>
                        </div>
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            
            // Wait for content to load then print
            setTimeout(() => {
                printWindow.print();
            }, 500);
        }
        // Modal accessibility functions
        function trapFocusInModal(modal) {
            const focusableElements = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            if (focusableElements.length === 0) return;
            
            const firstElement = focusableElements[0];
            const lastElement = focusableElements[focusableElements.length - 1];
            
            const handleTabKey = (e) => {
                if (e.key === 'Tab') {
                    if (e.shiftKey) { // Shift + Tab
                        if (document.activeElement === firstElement) {
                            lastElement.focus();
                            e.preventDefault();
                        }
                    } else { // Tab
                        if (document.activeElement === lastElement) {
                            firstElement.focus();
                            e.preventDefault();
                        }
                    }
                }
            };
            
            modal.addEventListener('keydown', handleTabKey);
            
            // Return a cleanup function to remove the event listener
            return () => {
                modal.removeEventListener('keydown', handleTabKey);
            };
        }
        
        // Close matrix modal
        function closeMatrixModal() {
            matrixModal.style.display = 'none';
            matrixModal.setAttribute('aria-hidden', 'true');
            // Return focus to the button that opened the modal
            matrixButton.focus();
        }
        
        // Close compare modal
        function closeCompareModal() {
            compareModal.style.display = 'none';
            compareModal.setAttribute('aria-hidden', 'true');
            // Return focus to the button that opened the modal
            compareProfilesBtn.focus();
        }
    });
</script>
</body>
</html>
